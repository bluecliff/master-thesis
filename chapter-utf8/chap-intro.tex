
\chapter{绪论}
\label{chap:introduction}

\section{研究意义和背景介绍}

DNA(脱氧核糖核酸)是生物遗传信息的载体，其双螺旋结构的两个链互相补充，构成稳定结构。其中每个链都含有完备的遗传信息，这些
遗传信息体现在构成DNA链的四种碱基——腺嘌呤（A），胸腺嘧啶（T），鸟嘌呤（C）和胞嘧啶（G）的排列顺序上。在现代生物学研究中，
为分析DNA的遗传表达等特性，需要特定对物种DNA进行测序。早期的sanger测序作为第一代测序手段在人类基因组计划中起到了巨大的作用。

随着生物学，医学等相关科学的发展，新的DNA测序技术不断涌现，其中，以Illumina/Solexa为代表的NGS(NEXT-GENERATION SEQUENCING DAT)
技术以其低廉的测序成本和便捷快速的特点成为当前的主流DNA测序技术。基于这一新技术实现的测序机器每台工作一天就能产生数十亿的
短读序列(short reads)\cite{metzker2009sequencing}。NGS测序技术一般应用于两类测试场景，重测序(Resequencing)
和从头测序(de novo sequencing)，这也对应着产生了DNA分析领域的两个最核心的研究问题：比对(alignment)和重组(assembly)。
若测序的目标物种的基因序列之前还从未被测序过，那么从头测序就是研究的第一步，这需要关注把短读以最优方式连接起来。若测序目标
物种已经完成了测序，那么重测序关注的问题是如何把短读序列映射到已知的同物种基因组上，从而分析同源生物的个体基因差异，这个过
程就是本文关注短读比对(short read alignment)。由于每一次测序实验都会得到大量的短读(short reads)序列(5亿到20亿个)，同时生物
个体基因之间的差异会导致基因序列存在差异，短读映射面临着基因的近似比对和快速高效比对两个难题。本文即提出一种基于压缩后缀
数组索引算法的快速高效比对算法来解决这两个问题。

重测序得到的短读序列中每一个短读一般不超过1000个碱基(大多数情况下都是20到100个碱基的长度),但一次测序实验中短读数量都
会超过一千万个。参考序列是已经经过准确测序，重组后的已知基因组序列，比如人类基因组序列就是合并出来的总长达2.8G的DNA序列。
出于医疗，身份鉴别等原因会对某个具体的人进行再次DNA测序，这就是DNA重测序，此时测序得到的大量短读序列分析的第一步就是把
这些短读映射到参考序列上，对人类而言，大多都是映射到人类基因组序列上，也可以映射到一个人工合成的参考序列上。映射的过程是
对每一个短读在参考序列上查找的过程，即要在参考序列上找到一个合适的位置，使得从这个位置开始，短读是参考序列的一个子串。

综上所述，短读序列的比对问题可以抽象为一个模式查找问题：给定一个共有$m$个模式的模式集合$P=\{P_1,P_2\ldots P_m\}$，每个
模式的长度已知分别为$l_1,l_2\ldots l_m$，已知一个长为$n$的参考序列$T$，求得一个集合$S=\{s_1,s_2\ldots s_n\}$使
得$P_i=T[s_i\ldots s_i+l_i-1]$。这个查找的过程即为短读到参考序列的比对映射。其中参考序列$T$和短读序列$P_i$都是由DNA测序
中常用的碱基字符$\{A,T,C,G,N\}$构成的。

\section{国内外研究现状}
为实现快速且准确的短读序列映射，近年来出现了很多比对算法。所有这些算法都可以分为两类，一类是通过对短读序列使用散列表等方法建
立短读序列的索引，之后遍历整个参考序列。另一类是为参考序列建立索引，之后再对每个短读进行独立的比对。

第一类比对算法的代表是MAQ，ZOOM，SHRiMP等。MAQ\cite{li2008mapping}基于散列技术，结合短读中每一个核苷酸的测序质量分数，实现了
无空位(ungapped)比对。ZOOM\cite{lin2008zoom}使用了space seeds技术，提高了比对的精确率。而SHRiMP\cite{rumble2009shrimp}则结合space seeds''
和smith-water算法得到了更高的精确率。

第二类算法为参考序列建立索引，通过索引后的数据可以实现快速的比对。如SOAP,WHAM,BFAST等。SOAP\cite{li2008soap}使用seeds技术
和一个散列查询表加速比对，且可以处理较少的空位比对。WHAM\cite{li2012wham}对参考序列建立散列表，先通过散列表查找潜在的比对位置，再进一步比对确定最终结果。BFAST则通过
为参考序列建立多个索引来提高精确度。这几种方法使用的索引方法都需要很大的内存空间，所以比对时空间需求很大，尤其是在用类基因
组这样的较大序列作为参考序列时。在第二类方法中以SOAP2,Bowtie,BWA为代表的基于BW变换(Burrows-Wheeler transform,BWT)\cite{ferragina2005indexing}来创建参考序列
索引的方法具有很大的空间优势。Bowtie\cite{langmead2009ultrafast}使用BWT建立索引，采用回溯递归
的搜索方法，再结合双端搜索实现了高速，空间高效的比对，是目前最快的比对软件之一，但缺陷是不能实现空位(gap)比对。BWA\cite{li2009fast}
也是基于BWT的一种比对算法，比对速度较Bowtie慢，但可实现空位比对。SOAP2\cite{li2009soap2}使用了bidirectional BWT来建立参考序列
的索引，比对速度和Bowtie相当。基于BWT的这些方法都使用了后向搜索方法\cite{lippert2005space}来加速查询。后向搜索可以在$O(m)$时间内实
现长为$m$的字符串的计数查询，以及$O(m\log n)$时间复杂度的query查询。利用后向搜索的性质，Bowtie实现了基于
回溯法的非精确匹配算法，而BWA则采用前缀树搜索的方法实现非精确匹配。在实现非精确匹配的基础上，加上一些打分机制，既实现了短读
序列到参考序列的匹配。

\section{本文的主要内容及组织结构}

本文提出一种采用压缩后缀数组(COmpressed Suffix Array,CSA)建立
索引\cite{grossi2005compressed},实现短读比对的算法:CSAA(csa alienment)。这一算法采用的是CSA的后向搜索特性，同时还使用了
优先队列来保存所有可能的匹配位置，并为每个可能的匹配位置打分，在匹配过程中，通过分支限界抛弃所有低分搜索方向，降低搜索空间，
同时保证匹配结果最优。按照上一节中对短读比对算法的分类，该算法属于对参考序列进行索引的比对算法。

